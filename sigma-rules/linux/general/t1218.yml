title: Dynamic Linker (ld.so) Creation
id: 56d95979-56d9-46d9-a6d9-56d959790000
status: stable
description: Detection rule for MITRE ATT&CK technique T1218
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/linux/defense_evasion_ld_so_creation.toml
author: elastic (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1218
logsource:
  product: linux
  service: general
detection:
  selection:
    # Original elastic detection logic
    # file where host.os.type == "linux" and event.type == "creation" and process.executable != null and
    # file.path like~ ("/lib/ld-linux*.so*", "/lib64/ld-linux*.so*", "/usr/lib/ld-linux*.so*", "/usr/lib64/ld-linux*.so*") and
    # not (
    #   process.executable in (
    #     "/bin/dpkg", "/usr/bin/dpkg", "/bin/dockerd", "/usr/bin/dockerd", "/usr/sbin/dockerd", "/bin/microdnf",
    #     "/usr/bin/microdnf", "/bin/rpm", "/usr/bin/rpm", "/bin/snapd", "/usr/bin/snapd", "/bin/yum", "/usr/bin/yum",
    #     "/bin/dnf", "/usr/bin/dnf", "/bin/podman", "/usr/bin/podman", "/bin/dnf-automatic", "/usr/bin/dnf-automatic",
    #     "/bin/pacman", "/usr/bin/pacman", "/usr/bin/dpkg-divert", "/bin/dpkg-divert", "/sbin/apk", "/usr/sbin/apk",
    #     "/usr/local/sbin/apk", "/usr/bin/apt", "/usr/sbin/pacman", "/bin/podman", "/usr/bin/podman", "/usr/bin/puppet",
    #     "/bin/puppet", "/opt/puppetlabs/puppet/bin/puppet", "/usr/bin/chef-client", "/bin/chef-client",
    #     "/bin/autossl_check", "/usr/bin/autossl_check", "/proc/self/exe", "/dev/fd/*",  "/usr/bin/pamac-daemon",
    #     "/bin/pamac-daemon", "/usr/lib/snapd/snapd", "/usr/local/bin/dockerd", "/usr/libexec/platform-python",
    #     "/usr/lib/snapd/snap-update-ns", "./usr/bin/podman", "/usr/bin/crio", "/usr/bin/buildah", "/bin/dnf5",
    #     "/usr/bin/dnf5", "/usr/bin/pamac", "/dev/fd/3"
    #   ) or
    #   process.executable like (
    #     "/snap/docker/*/bin/dockerd", "/usr/bin/python*", "/nix/store/*/docker/dockerd", "/var/lib/docker/overlay2/*/dockerd",
    #     "/rpool/data/*usr/bin/dockerd"
    #   )
    # )
  condition: selection
level: medium
