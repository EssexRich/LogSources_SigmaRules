title: Deprecated - Potential Reverse Shell via Suspicious Parent Process
id: 1169b532-1169-4169-a169-1169b5320000
status: stable
description: Detection rule for MITRE ATT&CK technique T1071
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/_deprecated/execution_shell_suspicious_parent_child_revshell_linux.toml
author: elastic (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1071
logsource:
  product: linux
  service: general
detection:
  selection:
    # Original elastic detection logic
    # sequence by host.id, process.parent.entity_id with maxspan=1s
    # [ process where host.os.type == "linux" and event.type == "start" and event.action == "fork" and (
    #   (process.name : "python*" and process.args == "-c" and not process.args == "/usr/bin/supervisord") or
    #   (process.name : "php*" and process.args == "-r") or
    #   (process.name : "perl" and process.args == "-e") or
    #   (process.name : "ruby" and process.args in ("-e", "-rsocket")) or
    #   (process.name : "lua*" and process.args == "-e") or
    #   (process.name : "openssl" and process.args : "-connect") or
    #   (process.name : ("nc", "ncat", "netcat") and process.args_count >= 3 and not process.args == "-z") or
    #   (process.name : "telnet" and process.args_count >= 3) or
    #   (process.name : "awk")) and 
    #   process.parent.name : ("python*", "php*", "perl", "ruby", "lua*", "openssl", "nc", "netcat", "ncat", "telnet", "awk") ]
    # [ network where host.os.type == "linux" and event.type == "start" and event.action in ("connection_attempted", "connection_accepted") and 
    #   process.name : ("python*", "php*", "perl", "ruby", "lua*", "openssl", "nc", "netcat", "ncat", "telnet", "awk") and
    #   destination.ip != null and destination.ip != "127.0.0.1" and destination.ip != "::1" ]
  condition: selection
level: medium
