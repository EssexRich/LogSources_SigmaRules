title: Potential Linux Reverse Connection through Port Knocking
id: 42804624-4280-4280-a280-428046240000
status: stable
description: Detection rule for MITRE ATT&CK technique T1205.001
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/_deprecated/command_and_control_linux_port_knocking_reverse_connection.toml
author: elastic (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1205.001
logsource:
  product: linux
  service: general
detection:
  selection:
    # Original elastic detection logic
    # sequence by host.id with maxspan=10s
    #   [network where host.os.type == "linux" and event.action in ("connection_accepted", "connection_attempted") and 
    #     event.type == "start" and process.name : "*" and (
    #       process.name : (
    #         "python*", "php*", "perl*", "ruby", "lua*", "openssl", "nc", "netcat", "ncat", "telnet",
    #         "awk", "gawk", "mawk", "nawk", "bash", "dash", "sh", "tcsh", "csh", "zsh", "ksh"
    #       ) or not process.executable : ("/usr/bin/*", "/bin/*")
    #     ) and not (
    #        cidrmatch(destination.ip, "127.0.0.0/8", "169.254.0.0/16", "224.0.0.0/4", "::1") or destination.port in (
    #          20, 21, 22, 23, 25, 53, 67, 68, 69, 80, 110, 123, 137, 138, 139, 143, 161, 162, 179, 443, 445, 465, 514, 515,
    #          587,636, 989, 990, 993, 995, 1025, 1026, 1080, 1194, 1433, 1434, 1521, 1701, 1723, 1812, 1813, 2082, 2083, 2086,
    #          2087, 2095, 2096, 2121, 2483, 2484, 3306, 3389, 3478, 3497, 3544, 3689, 3784, 3785, 389, 3998, 5060, 5061, 5190,
    #          5222, 5223, 5228, 5432, 5500, 554, 5631, 5632, 5800, 5801, 5900, 5901, 8000, 8008, 8080, 8081, 8443, 8888, 9100,
    #          9200, 9443, 10000
    #        ) or source.port in (
    #          20, 21, 22, 23, 25, 53, 67, 68, 69, 80, 110, 123, 137, 138, 139, 143, 161, 162, 179, 443, 445, 465, 514, 515,
    #          587, 636, 989, 990, 993, 995, 1025, 1026, 1080, 1194, 1433, 1434, 1521, 1701, 1723, 1812, 1813, 2082, 2083, 2086,
    #          2087, 2095, 2096, 2121, 2483, 2484, 3306, 3389, 3478, 3497, 3544, 3689, 3784, 3785, 389, 3998, 5060, 5061, 5190,
    #          5222, 5223, 5228, 5432, 5500, 554, 5631, 5632, 5800, 5801, 5900, 5901, 8000, 8008, 8080, 8081, 8443, 8888, 9100,
    #          9200, 9443, 10000)
    #       )
    #   ] by destination.ip
    #   [network where event.dataset == "network_traffic.flow" and host.os.type == "linux" and event.action == "network_flow"
    #     and event.type == "connection" and source.packets == 1 and flow.final == false and not (
    #       cidrmatch(destination.ip, "127.0.0.0/8", "169.254.0.0/16", "224.0.0.0/4", "::1") or destina
    # ... [truncated]
  condition: selection
level: medium
