title: Linux Command History Tampering
id: 4412befe-4412-4412-a412-4412befe0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1070.003
references:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/linux/builtin/lnx_shell_clear_cmd_history.yml
author: sigma (via IncidentBuddy)
date: 2026-01-28
tags:
  - attack.t1070.003
logsource:
  product: linux
  service: general
detection:
  selection:
    # Original sigma detection logic
    #     keywords:
    #         - 'cat /dev/null >*sh_history'
    #         - 'cat /dev/zero >*sh_history'
    #         - 'chattr +i*sh_history'
    #         - 'echo "" >*sh_history'
    #         - 'empty_bash_history'
    #         - 'export HISTFILESIZE=0'
    #         - 'history -c'
    #         - 'history -w'
    #         - 'ln -sf /dev/null *sh_history'
    #         - 'ln -sf /dev/zero *sh_history'
    #         - 'rm *sh_history'
    #         - 'shopt -ou history'
    #         - 'shopt -uo history'
    #         - 'shred *sh_history'
    #         - 'truncate -s0 *sh_history'
    #         # - 'unset HISTFILE'  # prone to false positives
    #     condition: keywords
    # 
  condition: selection
level: medium
