title: File Execution Permission Modification Detected via Defend for Containers
id: 2bca79b8-2bca-4bca-abca-2bca79b80000
status: stable
description: Detection rule for MITRE ATT&CK technique T1222
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/integrations/cloud_defend/execution_suspicious_file_made_executable_via_chmod_inside_a_container.toml
author: elastic (via IncidentBuddy)
date: 2026-01-28
tags:
  - attack.t1222
logsource:
  product: linux
  service: general
detection:
  selection:
    # Original elastic detection logic
    # file where host.os.type == "linux" and event.type in ("change", "creation") and (
    #   process.name == "chmod" or
    #   (
    #     /* account for tools that execute utilities as a subprocess, in this case the target utility name will appear as a process arg */
    #     process.name in ("bash", "dash", "sh", "tcsh", "csh", "zsh", "ksh", "fish", "busybox") and
    #     process.args in (
    #       "chmod", "/bin/chmod", "/usr/bin/chmod", "/usr/local/bin/chmod"
    #     ) and
    #     /* default exclusion list to not FP on default multi-process commands */
    #     not process.args in (
    #       "which", "/bin/which", "/usr/bin/which", "/usr/local/bin/which",
    #       "man", "/bin/man", "/usr/bin/man", "/usr/local/bin/man"
    #     )
    #   )
    # ) and process.args in ("4755", "755", "777", "0777", "444", "+x", "a+x") and
    # process.args like ("/dev/shm/*", "/tmp/*", "/var/tmp/*", "/run/*", "/var/run/*", "/mnt/*", "/media/*") and
    # process.interactive == true and container.id like "*" and not process.args == "-x"
  condition: selection
level: medium
