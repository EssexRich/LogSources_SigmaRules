title: Unusual Interactive Shell Launched from System User
id: 4fc41bc0-4fc4-4fc4-afc4-4fc41bc00000
status: stable
description: Detection rule for MITRE ATT&CK technique T1564.002
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/linux/defense_evasion_interactive_shell_from_system_user.toml
author: elastic (via IncidentBuddy)
date: 2026-02-01
tags:
  - attack.t1564.002
logsource:
  product: linux
  service: general
detection:
  selection:
    # Original elastic detection logic
    # event.category:process and host.os.type:linux and event.type:start and event.action:exec and user.name:(
    #    daemon or bin or sys or sync or games or man or mail or news or uucp or proxy or backup or list or irc
    #    or gnats or _apt or Debian-exim or systemd-timesync or messagebus or uuidd or _chrony or sshd or
    #    gamer or shutdown or halt or dbus or polkitd or rtkit or pipewire or tcpdump or clevis or
    #    libstoreagemgmt or geoclue or tss or sssd or gnome-initial-setup or pesign or dnsmasq or chrony
    # ) and process.interactive:true and process.parent.executable:* and not (
    #   process.parent.name:(
    #     apt-key or apt-config or gpgv or gpgconf or man-db.postinst or sendmail or rpm or nullmailer-inject
    #   ) or
    #   process.args:(/etc/apt/trusted.gpg.d/* or /tmp/apt-key-gpg* or "/usr/bin/dnf") or
    #   process.name:(awk or apt-config or dpkg or grep or gpgv or sed) or
    #   (user.name:_apt and process.name:(sqv or apt-key or gpgconf or sort or mktemp or find or cmp or gpg-connect-agent)) or
    #   (user.name:man and process.name:mandb) or
    #   (user.name:daemon and process.name:at) or
    #   process.parent.args:("/usr/bin/apt-key" or "/var/lib/dpkg/info/man-db.postinst") or
    #   process.parent.executable:(
    #     "/usr/lib/polkit-1/polkitd" or "./runc" or "/usr/bin/apt-get" or "/opt/gitlab/embedded/bin/bundle" or "/run/podman-init" or
    #     /tmp/newroot/* or /var/lib/docker/overlay2/* or /usr/libexec/platform-python*
    #   ) or
    #   process.parent.command_line:"runc init" or
    #   process.executable:(
    #     "/opt/gitlab/embedded/bin/bundle" or "/usr/bin/env" or "/usr/bin/readlink" or "/usr/bin/date" or "/usr/bin/dircolors" or
    #     "/usr/sbin/sendmail" or "/usr/bin/atrm" or "/usr/bin/atq" or "/run/podman-init" or "/usr/bin/basename" or "/usr/bin/locale" or
    #     "/usr/bin/tr"
    #   )
    # )
  condition: selection
level: medium
