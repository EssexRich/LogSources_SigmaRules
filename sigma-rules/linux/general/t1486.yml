title: Suspicious File Changes Activity Detected
id: 7594b1cb-7594-4594-a594-7594b1cb0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1486
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/_deprecated/impact_potential_linux_ransomware_file_encryption.toml
author: elastic (via IncidentBuddy)
date: 2026-01-28
tags:
  - attack.t1486
logsource:
  product: linux
  service: general
detection:
  selection:
    # Original elastic detection logic
    # sequence by process.entity_id, host.id with maxspan=1s
    #   [file where host.os.type == "linux" and event.type == "change" and event.action == "rename" and file.extension : "?*" 
    #    and process.executable : ("./*", "/tmp/*", "/var/tmp/*", "/dev/shm/*", "/var/run/*", "/boot/*", "/srv/*", "/run/*") and
    #    file.path : (
    #      "/home/*/Downloads/*", "/home/*/Documents/*", "/root/*", "/bin/*", "/usr/bin/*", "/var/log/*", "/var/lib/log/*",
    #      "/var/backup/*", "/var/www/*"
    #    ) and
    #    not process.name : (
    #      "dpkg", "yum", "dnf", "rpm", "dockerd", "go", "java", "pip*", "python*", "node", "containerd", "php", "p4d",
    #      "conda", "chrome", "imap", "cmake", "firefox", "semanage", "semodule", "ansible-galaxy", "fc-cache", "jammy", "git",
    #      "systemsettings", "vmis-launcher", "bundle", "kudu-tserver", "suldownloader"
    #     )
    #    ] with runs=25
  condition: selection
level: medium
