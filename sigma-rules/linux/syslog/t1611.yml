title: Kubernetes Container Created with Excessive Linux Capabilities
id: 126cbcac-126c-426c-a26c-126cbcac0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1611
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/integrations/kubernetes/privilege_escalation_container_created_with_excessive_linux_capabilities.toml
author: elastic (via IncidentBuddy)
date: 2026-01-28
tags:
  - attack.t1611
logsource:
  product: linux
  service: syslog
detection:
  selection:
    # Original elastic detection logic
    # event.dataset: kubernetes.audit_logs
    #   and kubernetes.audit.annotations.authorization_k8s_io/decision:"allow"
    #   and kubernetes.audit.verb: create
    #   and kubernetes.audit.objectRef.resource: pods
    #   and kubernetes.audit.requestObject.spec.containers.securityContext.capabilities.add: ("BPF" or "DAC_READ_SEARCH"  or "NET_ADMIN" or "SYS_ADMIN" or "SYS_BOOT" or "SYS_MODULE" or "SYS_PTRACE" or "SYS_RAWIO"  or "SYSLOG")
    #   and not kubernetes.audit.requestObject.spec.containers.image : ("docker.elastic.co/beats/elastic-agent:8.4.0" or "rancher/klipper-lb:v0.3.5" or "")
  condition: selection
level: medium
