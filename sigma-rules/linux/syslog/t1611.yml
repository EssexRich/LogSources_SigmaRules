title: Kubernetes Container Created with Excessive Linux Capabilities
id: 126cbcac-126c-426c-a26c-126cbcac0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1611
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/integrations/kubernetes/privilege_escalation_container_created_with_excessive_linux_capabilities.toml
author: elastic (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1611
logsource:
  product: linux
  service: syslog
detection:
  selection:
    # Original elastic detection logic
    # event.dataset: kubernetes.audit_logs and kubernetes.audit.annotations.authorization_k8s_io/decision:"allow" and
    # kubernetes.audit.verb: create and kubernetes.audit.objectRef.resource: pods and
    # kubernetes.audit.requestObject.spec.containers.securityContext.capabilities.add: ("BPF" or "DAC_READ_SEARCH"  or "NET_ADMIN" or "SYS_ADMIN" or "SYS_BOOT" or "SYS_MODULE" or "SYS_PTRACE" or "SYS_RAWIO"  or "SYSLOG") and
    # not (
    #   kubernetes.audit.requestObject.spec.containers.image : (docker.elastic.co/beats/elastic-agent* or rancher/klipper-lb* or "") or
    #   kubernetes.audit.objectRef.namespace:"kube-system" or
    #   (kubernetes.audit.objectRef.namespace:datadog and kubernetes.audit.requestObject.spec.containers.image:*datadog-agent*) or
    #   (kubernetes.audit.objectRef.namespace:kubearmor and kubernetes.audit.requestObject.spec.containers.image:(*kubearmor\:kubearmor* or kubearmor/kubearmor-snitch*)) or
    #   (kubernetes.audit.objectRef.namespace:defender and kubernetes.audit.requestObject.spec.containers.image:*fp-prisma\:defender-defender*) or
    #   (kubernetes.audit.objectRef.namespace:metallb-system and kubernetes.audit.requestObject.spec.containers.image:(quay.io/frrouting* or quay.io/metallb/speaker*)) or
    #   (kubernetes.audit.objectRef.namespace:longhorn-system and kubernetes.audit.requestObject.spec.containers.image:rancher/mirrored-longhornio*)
    # )
  condition: selection
level: medium
