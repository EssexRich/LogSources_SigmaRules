title: Suspicious Browser Child Process - MacOS
id: 40921fbd-4092-4092-a092-40921fbd0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1203
references:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_susp_browser_child_process.yml
author: sigma (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1203
logsource:
  product: macos
  service: general
detection:
  selection:
    # Original sigma detection logic
    #     selection:
    #         ParentImage|contains:
    #             - 'com.apple.WebKit.WebContent'
    #             - 'firefox'
    #             - 'Google Chrome Helper'
    #             - 'Google Chrome'
    #             - 'Microsoft Edge'
    #             - 'Opera'
    #             - 'Safari'
    #             - 'Tor Browser'
    #         Image|endswith:
    #             - '/bash'
    #             - '/curl'
    #             - '/dash'
    #             - '/ksh'
    #             - '/osascript'
    #             - '/perl'
    #             - '/php'
    #             - '/pwsh'
    #             - '/python'
    #             - '/sh'
    #             - '/tcsh'
    #             - '/wget'
    #             - '/zsh'
    #     filter_main_generic:
    #         CommandLine|contains: '--defaults-torrc' # Informs tor to use default config file
    #     filter_main_ms_autoupdate:
    #         CommandLine|contains: '/Library/Application Support/Microsoft/MAU*/Microsoft AutoUpdate.app/Contents/MacOS/msupdate' # Microsoft AutoUpdate utility
    #     filter_main_chrome:
    #         ParentImage|contains:
    #             - 'Google Chrome Helper'
    #             - 'Google Chrome'
    #         CommandLine|contains:
    #             - '/Volumes/Google Chrome/Google Chrome.app/Contents/Frameworks/*/Resources/install.sh' # Install the Google Chrome browser
    #             - '/Applications/Google Chrome.app/Contents/Frameworks/Google Chrome Framework.framework/*/Resources/keystone_promote_preflight.sh' # Updates the Google Chrome branding configuration files
    #             - '/Applications/Google Chrome.app/Contents/Frameworks/Google Chrome Framework.framework/*/Resources/keystone_promote_postflight.sh' # Script that performs the post-installation tasks
    #     filter_main_ms_edge:
    #         ParentImage|contains: 'Microsoft Edge'
    #         CommandLine|contains:
    #             - 'IOPlatformExpertDevice' # Retrieves the IOPlatformUUID (parent process - Microsoft Edge)
    #             - 'hw.model' # Retrieves model name of the computer's hardware (parent process - Microsoft Edge)
    #     filter_main_chromerecovery:
    #         ParentImage|contains:
    #             - 'Google Chrome Helper'
    #     
    # ... [truncated]
  condition: selection
level: medium
