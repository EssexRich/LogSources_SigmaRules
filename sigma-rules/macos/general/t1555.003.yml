title: Keychain Password Retrieval via Command Line
id: 6a54d90a-6a54-4a54-aa54-6a54d90a0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1555.003
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/macos/credential_access_keychain_pwd_retrieval_security_cmd.toml
author: elastic (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1555.003
logsource:
  product: macos
  service: general
detection:
  selection:
    # Original elastic detection logic
    # process where host.os.type == "macos" and event.action == "exec" and
    #  process.name == "security" and
    #  process.args like ("-wa", "-ga") and process.args like~ ("find-generic-password", "find-internet-password") and
    #  process.command_line : ("*Chrome*", "*Chromium*", "*Opera*", "*Safari*", "*Brave*", "*Microsoft Edge*", "*Firefox*") and
    #  not process.parent.executable like "/Applications/Keeper Password Manager.app/Contents/Frameworks/Keeper Password Manager Helper*/Contents/MacOS/Keeper Password Manager Helper*"
  condition: selection
level: medium
