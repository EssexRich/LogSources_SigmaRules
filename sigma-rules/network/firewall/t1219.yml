title: VNC (Virtual Network Computing) from the Internet
id: 505c633d-505c-405c-a05c-505c633d0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1219
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/network/command_and_control_vnc_virtual_network_computing_from_the_internet.toml
author: elastic (via IncidentBuddy)
date: 2026-01-28
tags:
  - attack.t1219
logsource:
  product: network
  service: firewall
detection:
  selection:
    # Original elastic detection logic
    # (event.dataset: network_traffic.flow or (event.category: (network or network_traffic))) and
    #   network.transport:tcp and destination.port >= 5800 and destination.port <= 5810 and
    #   not source.ip:(
    #     10.0.0.0/8 or
    #     127.0.0.0/8 or
    #     169.254.0.0/16 or
    #     172.16.0.0/12 or
    #     192.0.0.0/24 or
    #     192.0.0.0/29 or
    #     192.0.0.8/32 or
    #     192.0.0.9/32 or
    #     192.0.0.10/32 or
    #     192.0.0.170/32 or
    #     192.0.0.171/32 or
    #     192.0.2.0/24 or
    #     192.31.196.0/24 or
    #     192.52.193.0/24 or
    #     192.168.0.0/16 or
    #     192.88.99.0/24 or
    #     224.0.0.0/4 or
    #     100.64.0.0/10 or
    #     192.175.48.0/24 or
    #     198.18.0.0/15 or
    #     198.51.100.0/24 or
    #     203.0.113.0/24 or
    #     240.0.0.0/4 or
    #     "::1" or
    #     "FE80::/10" or
    #     "FF00::/8"
    #   ) and
    #   destination.ip:(
    #     10.0.0.0/8 or
    #     172.16.0.0/12 or
    #     192.168.0.0/16
    #   )
  condition: selection
level: medium
