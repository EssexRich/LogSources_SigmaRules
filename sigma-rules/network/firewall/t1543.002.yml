title: Suspicious Network Connection via systemd
id: 2b262966-2b26-4b26-ab26-2b2629660000
status: stable
description: Detection rule for MITRE ATT&CK technique T1543.002
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/linux/persistence_systemd_netcon.toml
author: elastic (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1543.002
logsource:
  product: network
  service: firewall
detection:
  selection:
    # Original elastic detection logic
    # sequence by host.id with maxspan=5s
    #   [process where host.os.type == "linux" and event.type == "start" and event.action == "exec" and
    #    process.parent.name == "systemd" and (
    #      process.name in (
    #        "openssl", "nc", "ncat", "netcat", "nc.openbsd", "nc.traditional", "socat", "busybox", "mkfifo",
    #        "nohup", "setsid", "xterm", "telnet"
    #      ) or
    #     (process.name : "python*" and process.args : "-c" and process.args : (
    #      "*import*pty*spawn*", "*import*subprocess*call*"
    #     )) or
    #     (process.name : "perl*" and process.args : "-e" and process.args : "*socket*" and process.args : (
    #      "*exec*", "*system*"
    #     )) or
    #     (process.name : "ruby*" and process.args : ("-e", "-rsocket") and process.args : (
    #      "*TCPSocket.new*", "*TCPSocket.open*"
    #      )) or
    #     (process.name : "lua*" and process.args : "-e" and process.args : "*socket.tcp*" and process.args : (
    #      "*io.popen*", "*os.execute*"
    #     )) or
    #     (process.name : "php*" and process.args : "-r" and process.args : "*fsockopen*" and process.args : "*/bin/*sh*") or 
    #     (process.name == "node" and process.args == "-e" and process.args : "*spawn*sh*" and process.args : "*connect*") or
    #     (process.name : ("awk", "gawk", "mawk", "nawk") and process.args : "*/inet/tcp/*") or
    #     (process.name in ("rvim", "vim", "vimdiff", "rview", "view") and process.args == "-c" and process.args : "*socket*")
    #   ) and
    #    not (
    #      process.args in ("/usr/bin/pg_ctlcluster", "/usr/bin/pveproxy", "/usr/sbin/pveum", "/usr/bin/pveupdate") or
    #      process.executable like (
    #        "/usr/local/cpanel/*/bin/perl", "/opt/puppetlabs/puppet/bin/ruby", "/opt/unified-monitoring-agent/embedded/bin/ruby"
    #      ) or
    #      process.command_line in (
    #        "/usr/bin/perl /usr/sbin/pveum realm sync planet",
    #        "/usr/bin/perl -T /usr/bin/pveproxy start", "/usr/bin/perl /usr/bin/pveupdate"
    #      )
    #    )
    #   ] by process.entity_id
    #   [network where host.os.type == "linux" and event.action == "connection_attempted" and event.type == "start" and
    #  
    # ... [truncated]
  condition: selection
level: medium
