title: DNS Query to External Service Interaction Domains
id: 1f9e7587-1f9e-4f9e-af9e-1f9e75870000
status: stable
description: Detection rule for MITRE ATT&CK technique T1190
references:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/network/dns/net_dns_external_service_interaction_domains.yml
author: sigma (via IncidentBuddy)
date: 2026-01-28
tags:
  - attack.t1190
logsource:
  product: network
  service: firewall
detection:
  selection:
    # Original sigma detection logic
    #     selection:
    #         query|endswith:
    #             - '.burpcollaborator.net' # Portswigger Burpsuite Collaborator
    #             - '.canarytokens.com' # Thinkst Canary Canarytokens
    #             - '.ceye.io'
    #             - '.ddns.1443.eu.org' # dig.pm
    #             - '.ddns.bypass.eu.org' # dig.pm
    #             - '.ddns.xn--gg8h.eu.org' # dig.pm
    #             - '.digimg.store' # dnslog.ink
    #             - '.dns.su18.org' # javaweb.org
    #             - '.dnshook.site' # webhook.site
    #             - '.dnslog.cn'
    #             - '.dnslog.ink' # dnslog.ink
    #             - '.instances.httpworkbench.com' # httpworkbench.com
    #             - '.interact.sh' # Project Discovery Interactsh
    #             - '.log.dnslog.pp.ua' # dnslog.org
    #             - '.log.dnslog.qzz.io' # dnslog.org
    #             - '.log.dnslogs.dpdns.org' # dnslog.org
    #             - '.log.javaweb.org' # javaweb.org
    #             - '.log.nat.cloudns.ph' # dnslog.org
    #             - '.oast.fun' # Project Discovery Interactsh
    #             - '.oast.live' # Project Discovery Interactsh
    #             - '.oast.me' # Project Discovery Interactsh
    #             - '.oast.online' # Project Discovery Interactsh
    #             - '.oast.pro' # Project Discovery Interactsh
    #             - '.oast.site' # Project Discovery Interactsh
    #             - '.oastify.com' # Portswigger Burpsuite Collaborator
    #             - '.p8.lol' # javaweb.org
    #             - '.requestbin.net'
    #     filter_main_polling:
    #         query|contains: 'polling.oastify.com'
    #     condition: selection and not 1 of filter_main_*
    # 
  condition: selection
level: medium
