title: Suspicious Non-Browser Network Communication With Google API
id: 740017e7-7400-4400-a400-740017e70000
status: stable
description: Detection rule for MITRE ATT&CK technique T1102
references:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_domain_google_api_non_browser_access.yml
author: sigma (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1102
logsource:
  product: network
  service: firewall
detection:
  selection:
    # Original sigma detection logic
    #     selection:
    #         DestinationHostname|contains:
    #             # Note: Please add additional google API related domains that might be abused.
    #             - 'drive.googleapis.com'
    #             - 'oauth2.googleapis.com'
    #             - 'sheets.googleapis.com'
    #             - 'www.googleapis.com'
    #     filter_optional_brave:
    #         Image|endswith: '\brave.exe'
    #     filter_optional_chrome:
    #         Image|endswith:
    #             - ':\Program Files\Google\Chrome\Application\chrome.exe'
    #             - ':\Program Files (x86)\Google\Chrome\Application\chrome.exe'
    #     filter_optional_google_drive:
    #         Image|contains: ':\Program Files\Google\Drive File Stream\'
    #         Image|endswith: '\GoogleDriveFS.exe'
    #     filter_optional_firefox:
    #         Image|endswith:
    #             - ':\Program Files\Mozilla Firefox\firefox.exe'
    #             - ':\Program Files (x86)\Mozilla Firefox\firefox.exe'
    #     filter_optional_ie:
    #         Image|endswith:
    #             - ':\Program Files (x86)\Internet Explorer\iexplore.exe'
    #             - ':\Program Files\Internet Explorer\iexplore.exe'
    #     filter_optional_maxthon:
    #         Image|endswith: '\maxthon.exe'
    #     filter_optional_edge_1:
    #         - Image|contains: ':\Program Files (x86)\Microsoft\EdgeWebView\Application\'
    #         - Image|endswith:
    #               - ':\Program Files (x86)\Microsoft\Edge\Application\msedge.exe'
    #               - ':\Program Files\Microsoft\Edge\Application\msedge.exe'
    #               - '\WindowsApps\MicrosoftEdge.exe'
    #     filter_optional_edge_2:
    #         Image|contains:
    #             - ':\Program Files (x86)\Microsoft\EdgeCore\'
    #             - ':\Program Files\Microsoft\EdgeCore\'
    #         Image|endswith:
    #             - '\msedge.exe'
    #             - '\msedgewebview2.exe'
    #     filter_optional_opera:
    #         Image|endswith: '\opera.exe'
    #     filter_optional_safari:
    #         Image|endswith: '\safari.exe'
    #     filter_optional_seamonkey:
    #         Image|endswith: '\seamonkey.exe'
    #     filter_optional_vivaldi:
    #         Image|endswith: '\vivaldi.exe'
    #     filter_optio
    # ... [truncated]
  condition: selection
level: medium
