title: Suspicious Network Connection Attempt by Root
id: 24cedb35-24ce-44ce-a4ce-24cedb350000
status: stable
description: Detection rule for MITRE ATT&CK technique T1548.003
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/_deprecated/command_and_control_connection_attempt_by_non_ssh_root_session.toml
author: elastic (via IncidentBuddy)
date: 2026-02-01
tags:
  - attack.t1548.003
logsource:
  product: network
  service: firewall
detection:
  selection:
    # Original elastic detection logic
    # sequence by process.entity_id with maxspan=1m
    # [network where host.os.type == "linux" and event.type == "start" and event.action == "connection_attempted" and user.id == "0" and
    #     not process.executable : ("/bin/ssh", "/sbin/ssh", "/usr/lib/systemd/systemd", "/usr/sbin/sshd","/usr/bin/ssh","/usr/bin/sshpass")]
    # [process where host.os.type == "linux" and event.action == "session_id_change" and user.id == "0" and
    #     not process.executable : ("/bin/ssh", "/sbin/ssh", "/usr/lib/systemd/systemd", "/usr/sbin/sshd","/usr/bin/ssh","/usr/bin/sshpass")]
  condition: selection
level: medium
