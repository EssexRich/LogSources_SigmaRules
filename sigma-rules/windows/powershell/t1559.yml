title: Suspicious Inter-Process Communication via Outlook
id: 648dd46d-648d-448d-a48d-648dd46d0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1559
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/windows/collection_email_outlook_mailbox_via_com.toml
author: elastic (via IncidentBuddy)
date: 2026-02-01
tags:
  - attack.t1559
logsource:
  product: windows
  service: powershell
detection:
  selection:
    # Original elastic detection logic
    # sequence with maxspan=1m
    # [process where host.os.type == "windows" and event.action == "start" and
    #   (
    #     process.name : (
    #       "rundll32.exe", "mshta.exe", "powershell.exe", "pwsh.exe",
    #       "cmd.exe", "regsvr32.exe", "cscript.exe", "wscript.exe"
    #     ) or
    #     (
    #       (process.code_signature.trusted == false or process.code_signature.exists == false) and
    #       (process.Ext.relative_file_creation_time <= 500 or process.Ext.relative_file_name_modify_time <= 500)
    #     )
    #   )
    # ] by process.entity_id
    # [process where host.os.type == "windows" and event.action == "start" and process.name : "OUTLOOK.EXE" and
    #   process.Ext.effective_parent.name != null] by process.Ext.effective_parent.entity_id
  condition: selection
level: medium
