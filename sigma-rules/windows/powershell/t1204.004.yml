title: Suspicious FileFix Execution Pattern
id: 6a89ad18-6a89-4a89-aa89-6a89ad180000
status: stable
description: Detection rule for MITRE ATT&CK technique T1204.004
references:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_filefix_execution_pattern.yml
author: sigma (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1204.004
logsource:
  product: windows
  service: powershell
detection:
  selection:
    # Original sigma detection logic
    #     selection_exec_parent:
    #         # This is case where phishing pages trick users to paste commands in browser file upload dialog
    #         ParentImage|endswith:
    #             - '\brave.exe'
    #             - '\chrome.exe'
    #             - '\firefox.exe'
    #             - '\msedge.exe'
    #         CommandLine|contains: '#'
    #     selection_cli_lolbin:
    #         CommandLine|contains:
    #             - '%comspec%'
    #             - 'bitsadmin'
    #             - 'certutil'
    #             - 'cmd'
    #             - 'cscript'
    #             - 'curl'
    #             - 'finger'
    #             - 'mshta'
    #             - 'powershell'
    #             - 'pwsh'
    #             - 'regsvr32'
    #             - 'rundll32'
    #             - 'schtasks'
    #             - 'wget'
    #             - 'wscript'
    #     selection_cli_captcha:
    #         CommandLine|contains:
    #             - 'account'
    #             - 'anti-bot'
    #             - 'botcheck'
    #             - 'captcha'
    #             - 'challenge'
    #             - 'confirmation'
    #             - 'fraud'
    #             - 'human'
    #             - 'identification'
    #             - 'identificator'
    #             - 'identity'
    #             - 'robot'
    #             - 'validation'
    #             - 'verification'
    #             - 'verify'
    #     condition: selection_exec_parent and 1 of selection_cli_*
    # 
  condition: selection
level: medium
