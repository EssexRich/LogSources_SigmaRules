title: Suspicious Spool Service Child Process
id: 03dc3d3c-03dc-43dc-a3dc-03dc3d3c0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1068
references:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_spoolsv_susp_child_processes.yml
author: sigma (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1068
logsource:
  product: windows
  service: powershell
detection:
  selection:
    # Original sigma detection logic
    #     spoolsv:
    #         ParentImage|endswith: '\spoolsv.exe'
    #         IntegrityLevel:
    #             - 'System'
    #             - 'S-1-16-16384'
    #     suspicious_unrestricted:
    #         Image|endswith:
    #             - '\gpupdate.exe'
    #             - '\whoami.exe'
    #             - '\nltest.exe'
    #             - '\taskkill.exe'
    #             - '\wmic.exe'
    #             - '\taskmgr.exe'
    #             - '\sc.exe'
    #             - '\findstr.exe'
    #             - '\curl.exe'
    #             - '\wget.exe'
    #             - '\certutil.exe'
    #             - '\bitsadmin.exe'
    #             - '\accesschk.exe'
    #             - '\wevtutil.exe'
    #             - '\bcdedit.exe'
    #             - '\fsutil.exe'
    #             - '\cipher.exe'
    #             - '\schtasks.exe'
    #             - '\write.exe'
    #             - '\wuauclt.exe'
    #             - '\systeminfo.exe'
    #             - '\reg.exe'
    #             - '\query.exe'
    #     suspicious_net:
    #         Image|endswith:
    #             - '\net.exe'
    #             - '\net1.exe'
    #     suspicious_net_filter:
    #         CommandLine|contains: 'start'
    #     suspicious_cmd:
    #         Image|endswith: '\cmd.exe'
    #     suspicious_cmd_filter:
    #         CommandLine|contains:
    #             - '.spl'
    #             - 'route add'
    #             - 'program files'
    #     suspicious_netsh:
    #         Image|endswith: '\netsh.exe'
    #     suspicious_netsh_filter:
    #         CommandLine|contains:
    #             - 'add portopening'
    #             - 'rule name'
    #     suspicious_powershell:
    #         Image|endswith:
    #             - '\powershell.exe'
    #             - '\pwsh.exe'
    #     suspicious_powershell_filter:
    #         CommandLine|contains: '.spl'
    #     suspicious_rundll32_img:
    #         - Image|endswith: '\rundll32.exe'
    #         - OriginalFileName: 'RUNDLL32.EXE'
    #     suspicious_rundll32_cli:
    #         CommandLine|endswith: 'rundll32.exe'
    #     condition: spoolsv and ( suspicious_unrestricted or (suspicious_net and not suspicious_net_filter) or (suspicious_cmd and not suspicious_cmd_filter) or (suspicious_netsh and not suspicious_netsh_filter) or (suspicious_powershell and not suspicious_powershell_filt
    # ... [truncated]
  condition: selection
level: medium
