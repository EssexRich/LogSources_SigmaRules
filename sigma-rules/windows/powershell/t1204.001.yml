title: Potential ClickFix Execution Pattern - Registry
id: 447219e8-4472-4472-a472-447219e80000
status: stable
description: Detection rule for MITRE ATT&CK technique T1204.001
references:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_potential_clickfix_execution.yml
author: sigma (via IncidentBuddy)
date: 2026-01-28
tags:
  - attack.t1204.001
logsource:
  product: windows
  service: powershell
detection:
  selection:
    # Original sigma detection logic
    #     selection_registry:
    #         TargetObject|contains: '\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RunMRU\'
    #     selection_details:
    #         Details|contains:
    #             - 'http://'
    #             - 'https://'
    #     selection_susp_pattern:
    #         - Details|contains:
    #               # Add more suspicious keywords
    #               - 'account'
    #               - 'anti-bot'
    #               - 'botcheck'
    #               - 'captcha'
    #               - 'challenge'
    #               - 'confirmation'
    #               - 'fraud'
    #               - 'human'
    #               - 'identification'
    #               - 'identificator'
    #               - 'identity'
    #               - 'robot'
    #               - 'validation'
    #               - 'verification'
    #               - 'verify'
    #         - Details|contains:
    #               - '%comspec%'
    #               - 'bitsadmin'
    #               - 'certutil'
    #               - 'cmd'
    #               - 'cscript'
    #               - 'curl'
    #               - 'finger'
    #               - 'mshta'
    #               - 'powershell'
    #               - 'pwsh'
    #               - 'regsvr32'
    #               - 'rundll32'
    #               - 'schtasks'
    #               - 'wget'
    #               - 'wscript'
    #     condition: all of selection_*
    # 
  condition: selection
level: medium
