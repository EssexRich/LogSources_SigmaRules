title: Potentially Suspicious EventLog Recon Activity Using Log Query Utilities
id: 618321ee-6183-4183-a183-618321ee0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1552
references:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_eventlog_content_recon.yml
author: sigma (via IncidentBuddy)
date: 2026-01-28
tags:
  - attack.t1552
logsource:
  product: windows
  service: powershell
detection:
  selection:
    # Original sigma detection logic
    #     selection_wmi:
    #         CommandLine|contains|all:
    #             - 'Select'
    #             - 'Win32_NTLogEvent'
    #     selection_wevtutil_img:
    #         - Image|endswith: '\wevtutil.exe'
    #         - OriginalFileName: 'wevtutil.exe'
    #     selection_wevtutil_cli:
    #         CommandLine|contains:
    #             - ' qe '
    #             - ' query-events '
    #     selection_wmic_img:
    #         - Image|endswith: '\wmic.exe'
    #         - OriginalFileName: 'wmic.exe'
    #     selection_wmic_cli:
    #         CommandLine|contains: ' ntevent'
    #     selection_cmdlet:
    #         CommandLine|contains:
    #             - 'Get-WinEvent '
    #             - 'get-eventlog '
    #     selection_logs_name:
    #         CommandLine|contains:
    #             # Note: Add more event log channels that are interesting for attackers
    #             - 'Microsoft-Windows-PowerShell'
    #             - 'Microsoft-Windows-Security-Auditing'
    #             - 'Microsoft-Windows-TerminalServices-LocalSessionManager'
    #             - 'Microsoft-Windows-TerminalServices-RemoteConnectionManager'
    #             - 'Microsoft-Windows-Windows Defender'
    #             - 'PowerShellCore'
    #             - 'Security'
    #             - 'Windows PowerShell'
    #     selection_logs_eid:
    #         CommandLine|contains:
    #             # Note: We use the "?" to account for both a single and a double quote
    #             # Note: Please add additional interesting event IDs
    #             # Note: As this only focuses on EIDs and we know EIDs are not unique across providers. Rare FPs might occur with legit queries to EIDs from different providers.
    #             # This covers EID 4624 and 4628 from Security Log
    #             - '-InstanceId 462?'
    #             - '.eventid -eq 462?'
    #             - '.ID -eq 462?'
    #             - 'EventCode=?462?'
    #             - 'EventIdentifier=?462?'
    #             - 'System[EventID=462?]'
    #             # This covers EID 4778 from Security Log
    #             - '-InstanceId 4778'
    #             - '.eventid -eq 4778'
    #             - '.ID -eq 4778'
    #             - 'EventCode=?4778?'
    #             - 'EventIdentifier=?4778?'
    #        
    # ... [truncated]
  condition: selection
level: medium
