title: HackTool - CrackMapExec Execution Patterns
id: 231c53f6-231c-431c-a31c-231c53f60000
status: stable
description: Detection rule for MITRE ATT&CK technique T1053
references:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_execution_patterns.yml
author: sigma (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1053
logsource:
  product: windows
  service: powershell
detection:
  selection:
    # Original sigma detection logic
    #     selection:
    #         CommandLine|contains:
    #             # cme/protocols/smb/wmiexec.py (generalized execute_remote and execute_fileless)
    #             - 'cmd.exe /Q /c * 1> \\\\*\\*\\* 2>&1'
    #             # cme/protocols/smb/atexec.py:109 (fileless output via share)
    #             - 'cmd.exe /C * > \\\\*\\*\\* 2>&1'
    #             # cme/protocols/smb/atexec.py:111 (fileless output via share)
    #             - 'cmd.exe /C * > *\\Temp\\* 2>&1'
    #             # https://github.com/byt3bl33d3r/CrackMapExec/blob/d8c50c8cbaf36c29329078662473f75e440978d2/cme/helpers/powershell.py#L136 (PowerShell execution with obfuscation)
    #             - 'powershell.exe -exec bypass -noni -nop -w 1 -C "'
    #             # https://github.com/byt3bl33d3r/CrackMapExec/blob/d8c50c8cbaf36c29329078662473f75e440978d2/cme/helpers/powershell.py#L160 (PowerShell execution without obfuscation)
    #             - 'powershell.exe -noni -nop -w 1 -enc '
    #     condition: selection
    # 
  condition: selection
level: medium
