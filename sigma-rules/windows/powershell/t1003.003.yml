title: NTDS.DIT Creation By Uncommon Process
id: 22e06785-22e0-42e0-a2e0-22e067850000
status: stable
description: Detection rule for MITRE ATT&CK technique T1003.003
references:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_ntds_dit_uncommon_process.yml
author: sigma (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1003.003
logsource:
  product: windows
  service: powershell
detection:
  selection:
    # Original sigma detection logic
    #     selection_ntds:
    #         TargetFilename|endswith: '\ntds.dit'
    #     selection_process_img:
    #         Image|endswith:
    #             # Add more suspicious processes as you see fit
    #             - '\cmd.exe'
    #             - '\cscript.exe'
    #             - '\mshta.exe'
    #             - '\powershell.exe'
    #             - '\pwsh.exe'
    #             - '\regsvr32.exe'
    #             - '\rundll32.exe'
    #             - '\wscript.exe'
    #             - '\wsl.exe'
    #             - '\wt.exe'
    #     selection_process_paths:
    #         Image|contains:
    #             - '\AppData\'
    #             - '\Temp\'
    #             - '\Public\'
    #             - '\PerfLogs\'
    #     condition: selection_ntds and 1 of selection_process_*
    # 
  condition: selection
level: medium
