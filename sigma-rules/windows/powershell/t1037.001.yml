title: Uncommon Userinit Child Process
id: 684bf7c3-684b-484b-a84b-684bf7c30000
status: stable
description: Detection rule for MITRE ATT&CK technique T1037.001
references:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_userinit_uncommon_child_processes.yml
author: sigma (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1037.001
logsource:
  product: windows
  service: powershell
detection:
  selection:
    # Original sigma detection logic
    #     selection:
    #         ParentImage|endswith: '\userinit.exe'
    #     filter_main_explorer:
    #         Image|endswith: ':\WINDOWS\explorer.exe'
    #     filter_optional_logonscripts:
    #         CommandLine|contains:
    #             - 'netlogon.bat'
    #             - 'UsrLogon.cmd'
    #     filter_optional_windows_core:
    #         # Note: This filter is mandatory on Windows Core machines as the default shell spawned by "userinit" is "powershell.exe".
    #         # https://learn.microsoft.com/en-us/windows-server/administration/server-core/server-core-sconfig#powershell-is-the-default-shell-on-server-core
    #         CommandLine: 'PowerShell.exe'
    #     filter_optional_proquota:
    #         Image|endswith:
    #             - ':\Windows\System32\proquota.exe'
    #             - ':\Windows\SysWOW64\proquota.exe'
    #     filter_optional_citrix:
    #         Image|endswith:
    #             # As reported by https://github.com/SigmaHQ/sigma/issues/4569
    #             - ':\Program Files (x86)\Citrix\HDX\bin\cmstart.exe' # https://support.citrix.com/article/CTX983798/purpose-of-cmstart-command
    #             - ':\Program Files (x86)\Citrix\HDX\bin\icast.exe' # https://support.citrix.com/article/CTX983798/purpose-of-cmstart-command
    #             - ':\Program Files (x86)\Citrix\System32\icast.exe'
    #             - ':\Program Files\Citrix\HDX\bin\cmstart.exe' # https://support.citrix.com/article/CTX983798/purpose-of-cmstart-command
    #             - ':\Program Files\Citrix\HDX\bin\icast.exe' # https://support.citrix.com/article/CTX983798/purpose-of-cmstart-command
    #             - ':\Program Files\Citrix\System32\icast.exe'
    #     filter_optional_image_null:
    #         Image: null
    #     condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
    # 
  condition: selection
level: medium
