title: Mmc LOLBAS Execution Process Spawn
id: 6b995c92-6b99-4b99-ab99-6b995c920000
status: stable
description: Detection rule for MITRE ATT&CK technique T1218.014
references:
  - https://github.com/splunk/security_content/blob/develop/detections/endpoint/mmc_lolbas_execution_process_spawn.yml
author: splunk (via IncidentBuddy)
date: 2026-02-01
tags:
  - attack.t1218.014
logsource:
  product: windows
  service: security
detection:
  selection:
    # Original splunk detection logic
    # | tstats `security_content_summariesonly` count min(_time) as firstTime max(_time)
    #   as lastTime from datamodel=Endpoint.Processes where (Processes.parent_process_name=mmc.exe)
    #   (Processes.process_name IN ("Regsvcs.exe", "Ftp.exe", "OfflineScannerShell.exe",
    #   "Rasautou.exe", "Schtasks.exe", "Xwizard.exe", "Dllhost.exe", "Pnputil.exe", "Atbroker.exe",
    #   "Pcwrun.exe", "Ttdinject.exe","Mshta.exe", "Bitsadmin.exe", "Certoc.exe", "Ieexec.exe",
    #   "Microsoft.Workflow.Compiler.exe", "Runscripthelper.exe", "Forfiles.exe", "Msbuild.exe",
    #   "Register-cimprovider.exe", "Tttracer.exe", "Ie4uinit.exe", "Bash.exe", "Hh.exe",
    #   "SettingSyncHost.exe", "Cmstp.exe", "Mmc.exe", "Stordiag.exe", "Scriptrunner.exe",
    #   "Odbcconf.exe", "Extexport.exe", "Msdt.exe", "WorkFolders.exe", "Diskshadow.exe",
    #   "Mavinject.exe", "Regasm.exe", "Gpscript.exe", "Rundll32.exe", "Regsvr32.exe", "Msiexec.exe",
    #   "Wuauclt.exe", "Presentationhost.exe", "Wmic.exe", "Runonce.exe", "Syncappvpublishingserver.exe",
    #   "Verclsid.exe", "Infdefaultinstall.exe", "Explorer.exe", "Installutil.exe", "Netsh.exe",
    #   "Wab.exe", "Dnscmd.exe", "At.exe", "Pcalua.exe", "Msconfig.exe")) by Processes.action
    #   Processes.dest Processes.original_file_name Processes.parent_process Processes.parent_process_exec
    #   Processes.parent_process_guid Processes.parent_process_id Processes.parent_process_name
    #   Processes.parent_process_path Processes.process Processes.process_exec Processes.process_guid
    #   Processes.process_hash Processes.process_id Processes.process_integrity_level Processes.process_name
    #   Processes.process_path Processes.user Processes.user_id Processes.vendor_product
    #   | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`
    #   | `mmc_lolbas_execution_process_spawn_filter`
  condition: selection
level: medium
