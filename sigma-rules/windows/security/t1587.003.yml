title: Windows Certutil Root Certificate Addition
id: 386ec9db-386e-486e-a86e-386ec9db0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1587.003
references:
  - https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_certutil_root_certificate_addition.yml
author: splunk (via IncidentBuddy)
date: 2026-02-01
tags:
  - attack.t1587.003
logsource:
  product: windows
  service: security
detection:
  selection:
    # Original splunk detection logic
    # | tstats `security_content_summariesonly` 
    #     count min(_time) as firstTime 
    #     max(_time) as lastTime
    #     values(Processes.process) as process 
    #   from datamodel=Endpoint.Processes where 
    #   `process_certutil` 
    #   Processes.process=*-addstore* 
    #   Processes.process=*root*
    #   Processes.process IN (
    #         "*:\\PerfLogs\\*",
    #         "*:\\Windows\\Temp\\*",
    #         "*\\AppData\\Local\\Temp\\*",
    #         "*\\ProgramData\\*",
    #         "*\\Users\\Public\\*",
    #         "*%AppData%*",
    #         "*%Public%*",
    #         "*%Temp%*",
    #         "*%tmp%*"
    #         )
    #   by Processes.action Processes.dest Processes.original_file_name
    #      Processes.parent_process Processes.parent_process_exec 
    #      Processes.parent_process_guid Processes.parent_process_id 
    #      Processes.parent_process_name Processes.parent_process_path
    #      Processes.process Processes.process_exec Processes.process_guid 
    #      Processes.process_hash Processes.process_id Processes.process_integrity_level 
    #      Processes.process_name Processes.process_path Processes.user 
    #      Processes.user_id Processes.vendor_product 
    #   | `drop_dm_object_name("Processes")`
    #   | `security_content_ctime(firstTime)` 
    #   |`security_content_ctime(lastTime)` 
    #   | `windows_certutil_root_certificate_addition_filter`
  condition: selection
level: medium
