title: Notepad++ Updater DNS Query to Uncommon Domains
id: 2402ef86-2402-4402-a402-2402ef860000
status: stable
description: Detection rule for MITRE ATT&CK technique T1195.002
references:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/dns_query/dns_query_win_gup_query_to_uncommon_domains.yml
author: sigma (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1195.002
logsource:
  product: windows
  service: general
detection:
  selection:
    # Original sigma detection logic
    #     selection:
    #         Image|endswith: '\gup.exe'
    #     filter_main_notepad_legit_domain:
    #         QueryName: 'notepad-plus-plus.org'
    #     filter_optional_sourceforge_legit_domain:
    #         QueryName|endswith: '.sourceforge.net'
    #     filter_optional_github_legit_domain:
    #         - QueryName|endswith: '.githubusercontent.com'
    #         - QueryName: 'github.com'
    #     filter_optional_google_storage_legit_domain:
    #         QueryName|endswith: '.googleapis.com'
    #     # Add other known legitimate domains if any
    #     condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
    # 
  condition: selection
level: medium
