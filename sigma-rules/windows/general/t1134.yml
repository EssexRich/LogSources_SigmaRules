title: Process Creation via Secondary Logon
id: 1dfd7875-1dfd-4dfd-adfd-1dfd78750000
status: stable
description: Detection rule for MITRE ATT&CK technique T1134
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/windows/privilege_escalation_create_process_as_different_user.toml
author: elastic (via IncidentBuddy)
date: 2026-01-28
tags:
  - attack.t1134
logsource:
  product: windows
  service: general
detection:
  selection:
    # Original elastic detection logic
    # sequence by winlog.computer_name with maxspan=1m
    # 
    # [authentication where host.os.type == "windows" and event.action:"logged-in" and
    #  event.outcome == "success" and user.id : ("S-1-5-21-*", "S-1-12-1-*") and
    # 
    #  /* seclogon service */
    #  process.name == "svchost.exe" and
    #  winlog.event_data.LogonProcessName : "seclogo*" and source.ip == "::1" ] by winlog.event_data.TargetLogonId
    # 
    # [process where host.os.type == "windows" and event.type == "start"] by winlog.event_data.TargetLogonId
  condition: selection
level: medium
