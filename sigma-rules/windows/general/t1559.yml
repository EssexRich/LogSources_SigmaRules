title: Potential Command and Control via Internet Explorer
id: 3140b7a8-3140-4140-a140-3140b7a80000
status: stable
description: Detection rule for MITRE ATT&CK technique T1559
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/windows/command_and_control_iexplore_via_com.toml
author: elastic (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1559
logsource:
  product: windows
  service: general
detection:
  selection:
    # Original elastic detection logic
    # sequence by host.id, user.name with maxspan = 5s
    #   [library where host.os.type == "windows" and dll.name : "IEProxy.dll" and process.name : ("rundll32.exe", "regsvr32.exe")]
    #   [process where host.os.type == "windows" and event.type == "start" and process.parent.name : "iexplore.exe" and process.parent.args : "-Embedding"]
    #   /* IE started via COM in normal conditions makes few connections, mainly to Microsoft and OCSP related domains, add FPs here */
    #   [network where host.os.type == "windows" and network.protocol == "dns" and process.name : "iexplore.exe" and
    #    not dns.question.name :
    #    (
    #     "*.microsoft.com",
    #     "*.digicert.com",
    #     "*.msocsp.com",
    #     "*.windowsupdate.com",
    #     "*.bing.com",
    #     "*.identrust.com",
    #     "*.sharepoint.com",
    #     "*.office365.com",
    #     "*.office.com"
    #     )
    #   ] /* with runs=5 */
  condition: selection
level: medium
