title: Enumeration Command Spawned via WMIPrvSE
id: 05ae6781-05ae-45ae-a5ae-05ae67810000
status: stable
description: Detection rule for MITRE ATT&CK technique T1016.001
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/windows/execution_enumeration_via_wmiprvse.toml
author: elastic (via IncidentBuddy)
date: 2026-02-01
tags:
  - attack.t1016.001
logsource:
  product: windows
  service: general
detection:
  selection:
    # Original elastic detection logic
    # process where host.os.type == "windows" and event.type == "start" and process.command_line != null and
    #   process.name:
    #   (
    #     "arp.exe", "dsquery.exe", "dsget.exe", "gpresult.exe", "hostname.exe", "ipconfig.exe", "nbtstat.exe",
    #     "net.exe", "net1.exe", "netsh.exe", "netstat.exe", "nltest.exe", "ping.exe", "qprocess.exe", "quser.exe",
    #     "qwinsta.exe", "reg.exe", "sc.exe", "systeminfo.exe", "tasklist.exe", "tracert.exe", "whoami.exe"
    #   ) and
    #   process.parent.name:"wmiprvse.exe" and
    #   not (
    #     process.name : "sc.exe" and process.args : "RemoteRegistry" and process.args : "start=" and
    #     process.args : ("demand", "disabled")
    #   ) and
    #   not process.args : "tenable_mw_scan"
  condition: selection
level: medium
