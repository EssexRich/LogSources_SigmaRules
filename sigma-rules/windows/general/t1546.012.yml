title: Potential Persistence Via App Paths Default Property
id: 4f4f6aee-4f4f-4f4f-af4f-4f4f6aee0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1546.012
references:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_persistence_app_paths.yml
author: sigma (via IncidentBuddy)
date: 2026-02-01
tags:
  - attack.t1546.012
logsource:
  product: windows
  service: general
detection:
  selection:
    # Original sigma detection logic
    #     selection:
    #         TargetObject|contains: '\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths'
    #         TargetObject|endswith:
    #             - '(Default)'
    #             - 'Path'
    #         Details|contains:
    #             # Add more suspicious paths or binaries as you see fit.
    #             - '\Users\Public'
    #             - '\AppData\Local\Temp\'
    #             - '\Windows\Temp\'
    #             - '\Desktop\'
    #             - '\Downloads\'
    #             - '%temp%'
    #             - '%tmp%'
    #             - 'iex'
    #             - 'Invoke-'
    #             - 'rundll32'
    #             - 'regsvr32'
    #             - 'mshta'
    #             - 'cscript'
    #             - 'wscript'
    #             - '.bat'
    #             - '.hta'
    #             - '.dll'
    #             - '.ps1'
    #     condition: selection
    # 
  condition: selection
level: medium
