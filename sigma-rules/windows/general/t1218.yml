title: Suspicious DotNET CLR Usage Log Artifact
id: 66a838bc-66a8-46a8-a6a8-66a838bc0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1218
references:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_net_cli_artefact.yml
author: sigma (via IncidentBuddy)
date: 2026-01-28
tags:
  - attack.t1218
logsource:
  product: windows
  service: general
detection:
  selection:
    # Original sigma detection logic
    #     selection:
    #         TargetFilename|endswith:
    #             - '\UsageLogs\cmstp.exe.log'
    #             - '\UsageLogs\cscript.exe.log'
    #             - '\UsageLogs\mshta.exe.log'
    #             - '\UsageLogs\msxsl.exe.log'
    #             - '\UsageLogs\regsvr32.exe.log'
    #             - '\UsageLogs\rundll32.exe.log'
    #             - '\UsageLogs\svchost.exe.log'
    #             - '\UsageLogs\wscript.exe.log'
    #             - '\UsageLogs\wmic.exe.log'
    #     filter_main_rundll32:
    #         # This filter requires the event to be enriched by additional information such as ParentImage and CommandLine activity
    #         ParentImage|endswith: '\MsiExec.exe'
    #         ParentCommandLine|contains: ' -Embedding'
    #         Image|endswith: '\rundll32.exe'
    #         CommandLine|contains|all:
    #             - 'Temp'
    #             - 'zzzzInvokeManagedCustomActionOutOfProc'
    #     condition: selection and not 1 of filter_main_*
    # 
  condition: selection
level: medium
