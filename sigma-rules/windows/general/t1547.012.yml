title: Potential Port Monitor or Print Processor Registration Abuse
id: 4d0b44e3-4d0b-4d0b-ad0b-4d0b44e30000
status: stable
description: Detection rule for MITRE ATT&CK technique T1547.012
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/windows/privilege_escalation_port_monitor_print_pocessor_abuse.toml
author: elastic (via IncidentBuddy)
date: 2026-02-01
tags:
  - attack.t1547.012
logsource:
  product: windows
  service: general
detection:
  selection:
    # Original elastic detection logic
    # registry where host.os.type == "windows" and event.type == "change" and
    #   registry.path : (
    #       "HKLM\\SYSTEM\\*ControlSet*\\Control\\Print\\Monitors\\*",
    #       "HKLM\\SYSTEM\\*ControlSet*\\Control\\Print\\Environments\\Windows*\\Print Processors\\*",
    #       "\\REGISTRY\\MACHINE\\SYSTEM\\*ControlSet*\\Control\\Print\\Monitors\\*",
    #       "\\REGISTRY\\MACHINE\\SYSTEM\\*ControlSet*\\Control\\Print\\Environments\\Windows*\\Print Processors\\*"
    #   ) and registry.data.strings : "*.dll" and
    #   /* exclude SYSTEM SID - look for changes by non-SYSTEM user */
    #   not user.id : "S-1-5-18"
  condition: selection
level: medium
