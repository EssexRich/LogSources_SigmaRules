title: Deprecated - Process Termination followed by Deletion
id: 34fab43a-34fa-44fa-a4fa-34fab43a0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1036.001
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/_deprecated/defense_evasion_process_termination_followed_by_deletion.toml
author: elastic (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1036.001
logsource:
  product: windows
  service: general
detection:
  selection:
    # Original elastic detection logic
    # sequence by host.id with maxspan=5s
    #    [process where host.os.type == "windows" and event.type == "end" and
    #     process.code_signature.trusted != true and
    #     not process.executable like
    #              ("C:\\Windows\\SoftwareDistribution\\*.exe",
    #               "C:\\Windows\\WinSxS\\*.exe",
    #               "?:\\Windows\\Postillion\\Office\\*.exe") and
    #     not (
    #       process.name : "infinst.exe" and process.parent.name: "dxsetup.exe" and
    #       process.parent.code_signature.subject_name == "NVIDIA Corporation" and
    #       process.parent.code_signature.status == "trusted"
    #     )
    #    ] by process.executable
    #    [file where host.os.type == "windows" and event.type == "deletion" and file.extension in~ ("exe", "scr", "com") and
    #     not process.executable like
    #              ("?:\\Program Files\\*.exe",
    #               "?:\\Program Files (x86)\\*.exe",
    #               "?:\\Windows\\System32\\svchost.exe",
    #               "?:\\Windows\\System32\\drvinst.exe",
    #               "?:\\Windows\\Postillion\\Office\\*.exe") and
    #     not file.path like (
    #           "?:\\Program Files\\*.exe",
    #           "?:\\Program Files (x86)\\*.exe",
    #           "?:\\Windows\\Temp\\*\\DismHost.exe",
    #           "?:\\$WINDOWS.~BT\\Work\\*\\DismHost.exe",
    #           "?:\\$WinREAgent\\Scratch\\*\\DismHost.exe",
    #           "?:\\Windows\\tenable_mw_scan_*.exe",
    #           "?:\\Users\\*\\AppData\\Local\\Temp\\LogiUI\\Pak\\uninstall.exe",
    #           "?:\\ProgramData\\chocolatey\\*.exe"
    #     ) and
    #     not (process.name : "OktaVerifySetup-*.exe" and process.code_signature.subject_name == "Okta, Inc.") and
    #     not (
    #       process.executable : "?:\\Windows\\SysWOW64\\config\\systemprofile\\Citrix\\UpdaterBinaries\\CitrixReceiver\\*" and
    #       process.code_signature.subject_name == "Citrix Systems, Inc." and
    #       file.path : "?:\\Windows\\SysWOW64\\config\\systemprofile\\Citrix\\UpdaterBinaries\\CitrixReceiver\\*\\bootstrapperhelper.exe"
    #     )
    #    ] by file.path
  condition: selection
level: medium
