title: Suspicious Execution via Windows Subsystem for Linux
id: e35c6fa6-cf63-4fa7-b362-b1cb8420f810
status: experimental
description: |
  Detection for MITRE ATT&CK technique T1059.004.
  Original source: elastic
references:
  - https://attack.mitre.org/techniques/T1059/004/
  - https://github.com/elastic/detection-rules/blob/main/rules/windows/defense_evasion_wsl_bash_exec.toml
author: GapMATRIX (sourced from elastic)
date: 2026-01-28
tags:
  - attack.t1059.004
logsource:
  product: windows
  service: defender
  category: process_creation
detection:
  selection:
    event.type: 'start'
    process.executable:
      - '?:\\Windows\\System32\\bash.exe'
      - '?:\\Users\\*\\AppData\\Local\\Packages\\*\\rootfs\\usr\\bin\\bash'
    process.command_line:
      - 'bash'
      - 'bash.exe'
    process.parent.name: 'wsl.exe'
    process.parent.command_line: 'bash*'
    process.name:
      - 'wslhost.exe'
      - 'wsl.exe'
    process.args:
      - 'curl'
      - '/mnt/c/*'
      - 'wsl-bootstrap'
      - '*.vscode-server*'
    process.parent.executable:
      - '?:\\Program Files\\Docker\\*.exe'
      - '?:\\Program Files (x86)\\Docker\\*.exe'
  condition: selection
falsepositives:
  - Legitimate administrative activity
level: medium
