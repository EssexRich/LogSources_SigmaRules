title: Python Initiated Connection
id: 7143f5a3-7143-4143-a143-7143f5a30000
status: stable
description: Detection rule for MITRE ATT&CK technique T1046
references:
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_python.yml
author: sigma (via IncidentBuddy)
date: 2026-02-01
tags:
  - attack.t1046
logsource:
  product: windows
  service: sysmon
detection:
  selection:
    # Original sigma detection logic
    #     selection:
    #         Initiated: 'true'
    #         Image|contains|all:
    #             - '\python'
    #             - '.exe'
    #     filter_optional_conda:
    #         # Related to anaconda updates. Command example: "conda update conda"
    #         # This filter will only work with aurora agent enriched data as Sysmon EID 3 doesn't contain CommandLine nor ParentImage
    #         ParentImage: C:\ProgramData\Anaconda3\Scripts\conda.exe
    #         CommandLine|contains|all:
    #             - ':\ProgramData\Anaconda3\Scripts\conda-script.py'
    #             - 'update'
    #     filter_optional_conda_jupyter_notebook:
    #         # Related to anaconda opening an instance of Jupyter Notebook
    #         # This filter will only work with aurora agent enriched data as Sysmon EID 3 doesn't contain CommandLine nor ParentImage
    #         ParentImage: C:\ProgramData\Anaconda3\python.exe
    #         CommandLine|contains: 'C:\ProgramData\Anaconda3\Scripts\jupyter-notebook-script.py'
    #     filter_main_local_communication:
    #         # This could be caused when launching an instance of Jupyter Notebook locally for example but can also be caused by other instances of python opening sockets locally etc. So comment this out if you want to monitor for those instances
    #         DestinationIp: 127.0.0.1
    #         SourceIp: 127.0.0.1
    #     filter_main_pip:
    #         CommandLine|contains|all:
    #             - 'pip.exe'
    #             - 'install'
    #     condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
    # 
  condition: selection
level: medium
