title: Potential Credential Access via Renamed COM+ Services DLL
id: 7e60b2c4-7e60-4e60-ae60-7e60b2c40000
status: stable
description: Detection rule for MITRE ATT&CK technique T1218.011
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/windows/credential_access_suspicious_comsvcs_imageload.toml
author: elastic (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1218.011
logsource:
  product: windows
  service: sysmon
detection:
  selection:
    # Original elastic detection logic
    # sequence by process.entity_id with maxspan=1m
    #  [process where host.os.type == "windows" and event.category == "process" and
    #     process.name : "rundll32.exe"]
    #  [process where host.os.type == "windows" and event.category == "process" and event.dataset : "windows.sysmon_operational" and event.code == "7" and
    #    (file.pe.original_file_name : "COMSVCS.DLL" or file.pe.imphash : "EADBCCBB324829ACB5F2BBE87E5549A8") and
    #     /* renamed COMSVCS */
    #     not file.name : "COMSVCS.DLL"]
  condition: selection
level: medium
