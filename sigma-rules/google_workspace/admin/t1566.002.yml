title: Google Workspace Object Copied to External Drive with App Consent
id: 50ab3e83-50ab-40ab-a0ab-50ab3e830000
status: stable
description: Detection rule for MITRE ATT&CK technique T1566.002
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/integrations/google_workspace/initial_access_object_copied_to_external_drive_with_app_consent.toml
author: elastic (via IncidentBuddy)
date: 2026-02-01
tags:
  - attack.t1566.002
logsource:
  product: google_workspace
  service: admin
detection:
  selection:
    # Original elastic detection logic
    # sequence by source.user.email with maxspan=3m
    # [file where event.dataset == "google_workspace.drive" and event.action == "copy" and
    # 
    #     /* Should only match if the object lives in a Drive that is external to the user's GWS organization */
    #     google_workspace.drive.owner_is_team_drive == "false" and google_workspace.drive.copy_type == "external" and
    # 
    #     /* Google Script, Forms, Sheets and Document can have container-bound scripts */
    #     google_workspace.drive.file.type: ("script", "form", "spreadsheet", "document")]
    # 
    # [any where event.dataset == "google_workspace.token" and event.action == "authorize" and
    # 
    #     /* Ensures application ID references custom app in Google Workspace and not GCP */
    #     google_workspace.token.client.id : "*apps.googleusercontent.com"]
  condition: selection
level: medium
