title: Google Calendar C2 via Script Interpreter
id: 7d780041-7d78-4d78-ad78-7d7800410000
status: stable
description: Detection rule for MITRE ATT&CK technique T1059
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/macos/command_and_control_google_calendar_c2_via_script.toml
author: elastic (via IncidentBuddy)
date: 2026-02-08
tags:
  - attack.t1059
logsource:
  product: google_workspace
  service: admin
detection:
  selection:
    # Original elastic detection logic
    # sequence by process.entity_id with maxspan=20s
    #   [network where host.os.type == "macos" and event.type == "start" and
    #     (process.name in ("node", "osascript") or process.name like "python*" or
    #      process.code_signature.trusted == false or process.code_signature.exists == false) and
    #     destination.domain like "calendar.app.google*"]
    #   [network where host.os.type == "macos" and event.type == "start" and destination.domain == null]
  condition: selection
level: medium
