title: Entra ID Service Principal Created
id: 627ba112-627b-427b-a27b-627ba1120000
status: stable
description: Detection rule for MITRE ATT&CK technique T1136
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/integrations/azure/persistence_entra_id_service_principal_created.toml
author: elastic (via IncidentBuddy)
date: 2026-02-01
tags:
  - attack.t1136
logsource:
  product: azure
  service: entra_id
detection:
  selection:
    # Original elastic detection logic
    # event.dataset:azure.auditlogs
    #     and azure.auditlogs.operation_name:"Add service principal"
    #     and event.outcome:(success or Success)
    #     and not azure.auditlogs.identity: (
    #         "Managed Service Identity" or
    #         "Windows Azure Service Management API" or
    #         "Microsoft Azure AD Internal - Jit Provisioning" or
    #         "AAD App Management" or
    #         "Power Virtual Agents Service"
    #         )
  condition: selection
level: medium
