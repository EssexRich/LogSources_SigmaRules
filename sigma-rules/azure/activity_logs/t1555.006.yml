title: Azure Storage Account Keys Accessed by Privileged User
id: 5ad2bbac-5ad2-4ad2-aad2-5ad2bbac0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1555.006
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/integrations/azure/credential_access_azure_storage_account_keys_accessed.toml
author: elastic (via IncidentBuddy)
date: 2026-02-01
tags:
  - attack.t1555.006
logsource:
  product: azure
  service: activity_logs
detection:
  selection:
    # Original elastic detection logic
    # event.dataset: "azure.activitylogs" and
    # azure.activitylogs.operation_name: "MICROSOFT.STORAGE/STORAGEACCOUNTS/LISTKEYS/ACTION" and
    # azure.activitylogs.identity.authorization.evidence.principal_type: "User" and
    # azure.activitylogs.identity.authorization.evidence.role: (
    #     "Owner" or
    #     "Contributor" or
    #     "Storage Account Contributor" or
    #     "User Access Administrator"
    # ) and event.outcome: "success"
  condition: selection
level: medium
