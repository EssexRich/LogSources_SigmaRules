title: Windows Defender Disabled via Registry Modification
id: 3061117f-3061-4061-a061-3061117f0000
status: stable
description: Detection rule for MITRE ATT&CK technique T1112
references:
  - https://github.com/elastic/detection-rules/blob/main/rules/windows/defense_evasion_defender_disabled_via_registry.toml
author: elastic (via IncidentBuddy)
date: 2026-02-01
tags:
  - attack.t1112
logsource:
  product: defender
  service: xdr
detection:
  selection:
    # Original elastic detection logic
    # registry where host.os.type == "windows" and event.type == "change" and
    #   (
    #     (
    #       registry.path: (
    #         "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\DisableAntiSpyware",
    #         "\\REGISTRY\\MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\DisableAntiSpyware"
    #       ) and
    #       registry.data.strings: ("1", "0x00000001")
    #    ) or
    #    (
    #       registry.path: (
    #         "HKLM\\System\\*ControlSet*\\Services\\WinDefend\\Start",
    #         "\\REGISTRY\\MACHINE\\System\\*ControlSet*\\Services\\WinDefend\\Start"
    #       ) and
    #       registry.data.strings in ("3", "4", "0x00000003", "0x00000004")
    #    )
    #   ) and
    # 
    #   not
    #     (
    #       process.executable : (
    #           "?:\\WINDOWS\\system32\\services.exe",
    #           "?:\\Windows\\System32\\svchost.exe",
    #           "?:\\Program Files (x86)\\Trend Micro\\Security Agent\\NTRmv.exe"
    #       ) and user.id : "S-1-5-18"
    #     )
  condition: selection
level: medium
