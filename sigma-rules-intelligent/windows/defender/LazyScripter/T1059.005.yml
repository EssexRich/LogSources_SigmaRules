title: Visual Basic (WINDOWS - defender)
id: 1c77ff16-dd69-47d6-a78d-adb2f8ab7b22
description: >
  Detects techniques consistent with MITRE ATT&CK technique T1059.005.
  Threat Actor: LazyScripter
references:
  - https://attack.mitre.org/techniques/T1059.005/
author: GapMATRIX Intelligent Sigma Generator
date: 2026-01-28
status: experimental
severity: medium

logsource:
  product: windows
  service: defender
  category: process_creation

detection:
  selection:
    InitiatingProcessFileName|contains:
      - 'cmd.exe'
      - 'powershell.exe'
      - 'bash'
      - 'sh'
    ProcessCommandLine|contains:
      - '-enc'
      - 'bypass'
      - 'encoded'
  condition: selection

falsepositives:
  - Legitimate system administration activity
  - Authorized security testing

tags:
  - attack.T1059.005
  - actor.lazyscripter
