title: Mshta (WINDOWS - defender)
id: 4e8e101b-f9a6-4adf-a1a7-c3432bfd9d8b
description: >
  Detects techniques consistent with MITRE ATT&CK technique T1218.005.
  Threat Actor: APT29
references:
  - https://attack.mitre.org/techniques/T1218.005/
author: GapMATRIX Intelligent Sigma Generator
date: 2026-01-28
status: experimental
severity: medium

logsource:
  product: windows
  service: defender
  category: process_creation

detection:
  selection:
    ParentImage|endswith|contains:
      - '\cscript.exe'
      - '\excel.exe'
      - '\mshta.exe'
    CommandLine|contains|contains:
      - 'javascript'
  condition: selection

falsepositives:
  - Legitimate system administration activity
  - Authorized security testing

tags:
  - attack.T1218.005
  - actor.apt29
