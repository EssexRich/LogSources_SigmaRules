title: Command and Scripting Interpreter (LINUX - auditd)
id: dffd7877-3853-4093-b8e3-9df569bbf35a
description: >
  Detects techniques consistent with MITRE ATT&CK technique T1059.
  Threat Actor: APT19
references:
  - https://attack.mitre.org/techniques/T1059/
author: GapMATRIX Intelligent Sigma Generator
date: 2026-01-28
status: experimental
severity: medium

logsource:
  product: linux
  service: auditd
  category: process_creation

detection:
  selection:
    type|contains:
      - 'PATH'
    name|contains:
      - '/var/run/haldrund.pid'
      - '/var/run/xinetd.lock'
      - '/var/run/kdevrund.pid'
    Image|endswith|contains:
      - '/capsh'
    CommandLine|contains|contains:
      - 'BEGIN {system'
    CommandLine|endswith|contains:
      - ' --'
  condition: selection

falsepositives:
  - Legitimate system administration activity
  - Authorized security testing

tags:
  - attack.T1059
  - actor.apt19
