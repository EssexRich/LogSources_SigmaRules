title: File and Directory Discovery (MACOS - unified_logging)
id: d6e8b5e1-d4d0-42d3-8cec-f7ba00c56aaa
description: >
  Detects techniques consistent with MITRE ATT&CK technique T1083.
  Threat Actor: DoNex
references:
  - https://attack.mitre.org/techniques/T1083/
author: GapMATRIX Intelligent Sigma Generator
date: 2026-01-28
status: experimental
severity: medium

logsource:
  product: macos
  service: unified_logging
  category: process_creation

detection:
  selection:
    Image|contains:
      - '/usr/bin/file'
    CommandLine|re|contains:
      - '(.){200,}'
    Image|endswith|contains:
      - '/find'
    CommandLine|contains|contains:
      - '-perm -4000'
      - '-perm -2000'
      - '-perm 0777'
  condition: selection

falsepositives:
  - Legitimate system administration activity
  - Authorized security testing

tags:
  - attack.T1083
  - actor.donex
